import{Y as D,Z as x,m as n,$ as W,_ as k,a0 as J,e as R,x as p,P as d,a1 as B,o as r,c as i,a as e,j as I,t as g,F as $,k as C,u as L,w as A,n as F,r as G,p as O,d as T,a2 as H,a3 as S,b as w,a4 as Z,z as U,v as z,T as K,U as Q,a5 as X,W as ee,a6 as te,a7 as j,f as oe,a8 as ae,a9 as se,y as re}from"./index.50f244e3.js";import{G as ne}from"./GroupGamesCard.f53d2885.js";class ie{constructor(t){this.accountId=t.accountId,this.id=t.id,this.groupId=t.groupId,this.profile=new D(t.profile),this.isOnline=t.isOnline||!1}}class ce{async addGroupMember(t){const o=await x.post("/api/groupmembers",{groupId:t});n.groupMembers=[new ie(o.data),...n.groupMembers]}async leaveGroup(t,o){n.groupMembers.find(h=>h.accountId==n.account.id)?await x.delete(`api/groupmembers/${t}`,o):(await x.delete(`api/groupmembers/${t}`),n.groupMembers=n.groupMembers.filter(h=>h.id!==t)),W.push({name:"Account"})}}const P=new ce;const de={props:{group:{type:J,required:!0}},setup(a){return{editable:R({}),groupMember:p(()=>n.groupMembers),alreadyAMember:p(()=>n.groupMembers.find(o=>o.accountId==n.account.id)),groupOwner:p(()=>a.group.creatorId==n.account.id),memberId:p(()=>n.groupMembers.find(o=>o.accountId==n.account.id)),async removeGroup(){try{if(this.groupOwner||d.toast("Forbidden: Not Your Group","warning","top-end",1e3),a.group.groupMemberIds>1&&d.toast("Group has members, leave group instead.","warning","top-end",1e3),!await d.confirm())return;await B.removeGroup(a.group.id),d.success("Group Removed")}catch(o){d.error(o,"[removeGroupMember]")}},async addGroupMember(){try{a.group.creatorId==n.account.id?d.error("Already made this group and are already part of it"):(await P.addGroupMember(a.group.id),d.success(`You Joined ${a.group.name} !`))}catch(o){d.error(o,"[addMemberToGroup]")}},async leaveGroup(){try{if(a.group.creatorId==n.account.id&&!await d.confirm("Are you sure you want to leave? You'll have to choose a new group owner...")||!await d.confirm("Are you sure you want to leave?"))return;await P.leaveGroup(this.memberId.id),d.success(`Left ${a.group.name}`)}catch(o){d.error(o,"[leaveGroup]")}},async editGroup(){}}}},N=a=>(O("data-v-3c4acde1"),a=a(),T(),a),ue={class:"d-flex"},le=N(()=>e("button",{class:"btn text-light hover rounded-circle",type:"button","data-bs-toggle":"collapse","data-bs-target":"#groupButtons","aria-expanded":"false","aria-controls":"collapseWidthExample"},[e("i",{class:"mdi mdi-dots-horizontal fs-1 text-white hover rounded-5 dropdownbtn"})],-1)),me={class:"collapse",id:"groupButtons"},pe={class:"logicButtons d-flex"},_e={key:0},he=N(()=>e("button",{class:"btn btn-warning button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#inviteMemberForm"}," Invite Member ",-1)),ge=[he],be=N(()=>e("button",{class:"btn button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#gameNightForm"}," Create Gamenight ",-1)),ve={key:1},ye={key:3},fe={key:5},Ge={class:"row justify-content-center mb-3"},we={class:"col-md-6 text-center bannerBg my-2 rounded text-light elevation-3"},xe={class:"name"},Ie={class:"mb-3"},$e=N(()=>e("span",null,[e("div",{class:"text-shadow fs-4"},"Members")],-1)),Ce={class:"d-flex justify-content-center align-items-center bg-c1 p-2 rounded-5 mb-2 groupMemberBar flex-wrap"},ke=["src","alt","title"],Me={key:0,class:"rounded-circle onlineThing bg-success position-absolute end-50 glow2"};function Be(a,t,o,s,h,b){var c,y;const m=G("router-link");return r(),i("div",{class:"col-md-11 rounded banner elevation-3",style:F({backgroundImage:`url(${(c=o.group)==null?void 0:c.coverImg})`})},[e("div",ue,[le,e("div",me,[e("div",pe,[s.groupOwner?(r(),i("div",_e,ge)):I("",!0),be,s.groupOwner?(r(),i("div",ve,[e("button",{onClick:t[0]||(t[0]=u=>s.editGroup()),class:"btn btn-warning button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#editForm"}," Edit group ")])):I("",!0),s.alreadyAMember?(r(),i("div",ye,[e("button",{onClick:t[2]||(t[2]=u=>s.leaveGroup()),class:"btn button-51 py-1 px-2 m-2"}," Leave Group ")])):(r(),i("button",{key:2,onClick:t[1]||(t[1]=u=>s.addGroupMember()),class:"btn button-50 py-1 px-2 m-2"}," Join Group ")),s.groupOwner?(r(),i("button",{key:4,onClick:t[3]||(t[3]=u=>s.removeGroup()),class:"btn btn-danger button-51 py-1 px-2 m-2"}," Delete Group ")):(r(),i("div",fe))])])]),e("div",Ge,[e("div",we,[e("span",xe,g((y=o.group)==null?void 0:y.name),1),e("div",Ie,[$e,e("div",Ce,[(r(!0),i($,null,C(s.groupMember,u=>(r(),L(m,{to:{name:"Profile",params:{id:u==null?void 0:u.accountId}},key:u==null?void 0:u.id},{default:A(()=>{var f,_,v;return[e("img",{src:(f=u.profile)==null?void 0:f.picture,alt:(_=u.profile)==null?void 0:_.name,title:(v=u.profile)==null?void 0:v.name,height:"45",width:"45",class:"rounded-circle box-shadow m-1 profile-img position-relative"},null,8,ke),u.profile.isOnline?(r(),i("span",Me)):I("",!0)]}),_:2},1032,["to"]))),128))])])])])],4)}const Se=k(de,[["render",Be],["__scopeId","data-v-3c4acde1"]]);const Ne={props:{gamenight:{type:H,required:!0}},setup(a){const t=["url(https://images.unsplash.com/photo-1500995617113-cf789362a3e1)","url(https://images.unsplash.com/photo-1611891487122-207579d67d98)","url(https://images.unsplash.com/photo-1547638375-ebf04735d792)","url(https://images.unsplash.com/photo-1606503153255-59d8b8b82176)","url(https://images.unsplash.com/photo-1561079028-f20597c34f21)","url(https://images.unsplash.com/photo-1606559497615-e4787c3c75a1)","url(https://images.unsplash.com/photo-1563811771046-ba984ff30900)"];return{gameNightCreator:p(()=>a.gamenight.creatorId==n.account.id),groupOwner:p(()=>a.gamenight.groupCreator==n.account.id),attending:p(()=>a.gamenight.groupMemberIds.find(o=>o.id==n.account.id)),memberGoing:p(()=>{seeTheSame(groupMembers,a.gamenight.groupMemberIds),seeTheSame(a.gamenight.groupMemberIds,groupMembers)}),getRandomBg(){return t[Math.floor(t.length*Math.random())]},seeTheSame(o,s){return o.filter(h=>s.some(b=>h.id===b.id))},async removeGameNight(){try{if(!await d.confirm("Cancel this gamenight??"))return;await S.removeGameNight(a.gamenight.id)}catch(o){console.error("[]",o),d.error(o)}},async addGameNight(){try{await S.addGameNight(a.gamenight.id)}catch(o){d.error(o)}},async attendGamenight(o){try{await S.attendGamenight(o)}catch(s){console.error(s),d.error(s.message)}}}}},M=a=>(O("data-v-ad52f30d"),a=a(),T(),a),Ae={class:"row justify-content-center"},Le={class:"col-7 col-md-8 rounded bg-c4 m-2 upcomingGameNight"},Oe={class:"d-flex justify-content-center mt-2 text-center"},Te=M(()=>e("h2",null,"Upcoming Gamenight",-1)),je={class:"d-flex justify-content-center mb-2"},Pe=U(" I'm Attending "),Ee=M(()=>e("i",{class:"bi bi-person-plus-fill"},null,-1)),De=[Pe,Ee],Re=U(" Unattend "),Fe=M(()=>e("i",{class:"bi bi-person-dash-fill"},null,-1)),Ue=[Re,Fe],ze={class:"justify-content-center d-flex"},Ve={class:"mx-4"},qe={class:"col-5 col-md-6 p-0 ps-md-3"},Ye={class:"card m-2 noborder"},We=M(()=>e("div",{class:"bg-c4 text-center rounded-top"},[e("h5",{class:"mt-1"},"Attending:")],-1)),Je={key:0,class:"p-2 bg-c2 text-center rounded-bottom"},He=["src","alt","title"],Ze={class:"col-5 col-md-6 p-0 pe-md-3"},Ke={class:"card m-2 noborder elevation-4"},Qe=M(()=>e("div",{class:"bg-c4 text-center p-1 rounded-top"},[e("h5",{class:"mt-1"},"Playing:")],-1)),Xe={class:"bg-c2 p-2 rounded-bottom"},et={class:"d-flex justify-content-center"},tt={class:"col-md- bg-c2 rounded-1 fs-5 text-center px-3 py-1 my-1"},ot={class:"namefont"};function at(a,t,o,s,h,b){var c,y,u,f,_;const m=G("router-link");return r(),i("div",{class:"GameNightCard card my-2 elevation-3 position-relative",style:F({backgroundImage:s.getRandomBg()})},[e("div",Ae,[e("div",Le,[e("div",Oe,[Te,s.gameNightCreator||s.groupOwner?(r(),i("i",{key:0,title:"Remove Game Night",class:"mdi mdi-close text-danger fs-4 selectable position-absolute rounded x",onClick:t[0]||(t[0]=v=>s.removeGameNight())})):I("",!0)]),e("div",je,[s.attending?(r(),i("button",{key:1,class:"btn button-51 animate__animated animate__fadeIn",onClick:t[2]||(t[2]=v=>{var l;return s.attendGamenight((l=o.gamenight)==null?void 0:l.id)})},Ue)):(r(),i("button",{key:0,class:"btn button-51 animate__animated animate__fadeIn",onClick:t[1]||(t[1]=v=>{var l;return s.attendGamenight((l=o.gamenight)==null?void 0:l.id)})},De))]),e("div",ze,[e("span",null,[e("p",null,g(new Date((c=o.gamenight)==null?void 0:c.startDate).toLocaleDateString("en-us",{month:"short",day:"2-digit",year:"numeric"})),1)]),e("span",Ve,[e("p",null,g(new Date((y=o.gamenight)==null?void 0:y.startDate).toLocaleTimeString("en-us",{hour:"2-digit",minute:"2-digit"})),1)]),e("span",null,[e("p",null,"At: "+g((u=o.gamenight)==null?void 0:u.location),1)])])]),e("div",qe,[e("div",Ye,[We,(f=o.gamenight)!=null&&f.groupMemberIds?(r(),i("div",Je,[w(Z,{name:"custom-classes",enterActiveClass:"animate__zoomIn animate__animated",leaveActiveClass:"animate__zoomOut animate__animated"},{default:A(()=>{var v;return[(r(!0),i($,null,C((v=o.gamenight)==null?void 0:v.groupMemberIds,l=>(r(),L(m,{to:{name:"Profile",params:{id:l==null?void 0:l.id}},key:l.id},{default:A(()=>[e("img",{src:l==null?void 0:l.picture,alt:l==null?void 0:l.name,title:l==null?void 0:l.name,height:"45",width:"45",class:"rounded-circle box-shadow m-1 profile-img"},null,8,He)]),_:2},1032,["to"]))),128))]}),_:1})])):I("",!0)])]),e("div",Ze,[e("div",Ke,[Qe,e("div",Xe,[e("div",et,[e("div",tt,[e("b",ot,g((_=o.gamenight)==null?void 0:_.game),1)])])])])])])],4)}const st=k(Ne,[["render",at],["__scopeId","data-v-ad52f30d"]]);class V{constructor(t){this.id=t.id,this.groupId=t.groupId,this.creatorId=t.creatorId,this.body=t.body,this.creator=new D(t.creator),this.createdExactTime=t.createdAt,this.createdAt=new Date(t.createdAt).toLocaleDateString("en-Us",{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"})}}class rt{async getGroupChatsByGroupId(t){const o=await x.get(`api/groupchats/${t}`);n.groupChats=o.data.map(s=>new V(s))}async addGroupChat(t){await x.post("api/groupchats/",t)}}const q=new rt,nt={setup(){let a=R({});const t=z();return{editable:a,async handleSubmit(){try{if(!n.account.id)return K.loginWithPopup();const o=t.params.id;a.value.groupId=o,await q.addGroupChat(a.value),a.value={}}catch(o){d.error(o,"handleChatSubmit")}}}}},it={class:"bg-dark rounded ms-2"},ct=e("div",{class:"row"},[e("div",{class:"d-flex justify-content-between"},[e("div",{class:"p-2 mt-2 ms-1"},"Add post. . ."),e("button",{class:"btn bg-c6 mx-2 my-2 rounded-pill",type:"submit","aria-label":"Submit Post",title:"Submit"}," Post ")])],-1),dt={class:"text-start d-flex justify-content-center"},ut={class:""},lt={class:"form-group text-center m-1"},mt=e("div",null,null,-1);function pt(a,t,o,s,h,b){return r(),i("div",it,[e("form",{onSubmit:t[1]||(t[1]=ee((...m)=>s.handleSubmit&&s.handleSubmit(...m),["prevent"]))},[ct,e("div",dt,[e("div",ut,[e("div",lt,[Q(e("textarea",{class:"p-2 rounded w-100",rows:"2","onUpdate:modelValue":t[0]||(t[0]=m=>s.editable.body=m),cols:"150",placeholder:"",required:"",name:"postcontent"},null,512),[[X,s.editable.body]])])]),mt])],32)])}const _t=k(nt,[["render",pt]]);const ht={props:{chat:{type:V,required:!0}},setup(a){return{account:p(()=>n.account)}}},gt={class:"chatContainer container animate__animated animate__fadeIn"},bt={class:"row"},vt={class:"col-12"},yt={key:0,class:"d-flex gap-1 justify-content-end pt-2 pb-2"},ft={class:"mt-2 time"},Gt={class:""},wt={key:1,class:"d-flex gap-1 justify-content-start animate__animated animate__fadeInLeft"},xt={class:"bg-c4 rounded p-2 my-2 max-width"},It=["src","alt","title"],$t={class:""},Ct={class:"mt-3 time"};function kt(a,t,o,s,h,b){var m,c;return r(),i("div",gt,[e("div",bt,[e("div",vt,[((m=o.chat)==null?void 0:m.creatorId)==((c=s.account)==null?void 0:c.id)?(r(),i("div",yt,[e("span",ft,g(o.chat.createdAt),1),e("div",{class:te(["bg-c2 rounded-3 p-2 max-width",s.account?"bg-c1 ":"bg-success"])},[e("span",Gt,g(o.chat.body),1)],2)])):(r(),i("div",wt,[e("div",xt,[e("img",{src:o.chat.creator.picture,alt:o.chat.creator.name,title:o.chat.creator.name,class:"rounded-circle me-2 profilePic",height:"20",width:"20"},null,8,It),e("span",$t,g(o.chat.body),1)]),e("span",Ct,g(o.chat.createdAt),1)]))])])])}const Mt=k(ht,[["render",kt],["__scopeId","data-v-17e6fe8c"]]);class E{static EnterGroup(t){j.emit("ENTER_GROUP",t)}static LeaveGroup(t){j.emit("LEAVE_GROUP",t)}}const Bt={setup(){const a=z();async function t(){try{await B.getGroupById(a.params.id)}catch(c){d.error(c,"[getGroupById]")}}async function o(){try{await B.getGroupMembers(a.params.id)}catch(c){d.error(c,"[getGroupMemberByGroupId]")}}async function s(){try{await re.getListsByGroupId(a.params.id)}catch(c){d.error(c,"[getListsByGroupId]")}}async function h(){try{await q.getGroupChatsByGroupId(a.params.id)}catch(c){d.error(c,"[getListsByGroupId]")}}async function b(){try{await S.getGroupGameNights(a.params.id)}catch(c){d.error(c,"[groupGameNights]")}}function m(){let c=document.getElementById("chatbox");if(!c)return setTimeout(m,500);c.scrollTop=9999}return oe(()=>{t(),o(),s(),h(),b(),m(),E.EnterGroup(a.params.id)}),ae(()=>{E.LeaveGroup(a.params.id)}),{chats:p(()=>n.groupChats),group:p(()=>n.activeGroup),lists:p(()=>n.groupFilteredLists),account:p(()=>n.account),gamenights:p(()=>n.groupGameNights.reverse()),groupOwner:p(()=>n.activeGroup.creatorId==n.account.id),async createGroup(){try{await B.createGroup()}catch(c){d.error(c,"[createGroup]")}}}},components:{GroupBanner:Se,GameNightCard:st,GroupChatInput:_t,GroupGamesCard:ne,Chat:Mt,GameNightForm:se}},Y=a=>(O("data-v-f9b2c4ae"),a=a(),T(),a),St={key:0,class:"animate__animated animate__fadeOut"},Nt={key:1,class:"group-page animate__animated animate__fadeInRight container-fluid"},At={class:"row justify-content-center mb-4 mt-2"},Lt={class:"row justify-content-center"},Ot={class:"col-md-3 bg-dark rounded mt-2"},Tt=Y(()=>e("div",{class:"bg-c6 rounded px-2 py-2 my-2 text-center mx-5"},[e("h4",null,"Group Chat")],-1)),jt={class:"overflow-auto groupchatbox bg-dark lighten-10 rounded",id:"chatbox"},Pt={class:"col-md-5 overflow-auto gamecardbox mx-5"},Et={class:"px-1"},Dt={class:"col-md-3 overflow-auto gamecardbox bg-dark pt-2 mt-2 rounded"},Rt=Y(()=>e("div",{class:"bg-c1 rounded text-center pt-2 pb-1 mx-5"},[e("h4",null,"Group Games")],-1)),Ft={class:"mt-2"},Ut={class:"row flex-wrap"};function zt(a,t,o,s,h,b){const m=G("GroupBanner"),c=G("Chat"),y=G("GroupChatInput"),u=G("GameNightCard"),f=G("GroupGamesCard");return s.group?(r(),i("div",Nt,[e("div",At,[w(m,{class:"mt-2 rounded",group:s.group},null,8,["group"])]),e("div",Lt,[e("div",Ot,[Tt,e("div",jt,[(r(!0),i($,null,C(s.chats,_=>(r(),i("div",{class:"col-md-12",key:_.id},[w(c,{chat:_},null,8,["chat"])]))),128))]),w(y)]),e("div",Pt,[e("div",Et,[(r(!0),i($,null,C(s.gamenights,_=>(r(),L(u,{gamenight:_},null,8,["gamenight"]))),256))])]),e("div",Dt,[Rt,e("div",Ft,[e("div",Ut,[(r(!0),i($,null,C(s.lists,_=>(r(),i("div",{key:_.id,class:"mt-4 col-12"},[w(f,{boardGameList:_},null,8,["boardGameList"])]))),128))])])])])])):(r(),i("div",St," loading.... "))}const Yt=k(Bt,[["render",zt],["__scopeId","data-v-f9b2c4ae"]]);export{Yt as default};
