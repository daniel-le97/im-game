import{Z as F,$ as C,m as n,a0 as X,_ as B,a1 as Z,e as U,x as p,P as d,a2 as S,o as r,c as i,a as e,j as $,t as g,F as k,k as M,u as O,w as L,n as V,r as f,p as j,d as T,a3 as K,a4 as N,z as D,b as I,a5 as Q,a6 as z,C as q,v as Y,U as ee,V as te,a7 as oe,X as ae,a8 as P,f as se,a9 as re,aa as ne,y as ie}from"./index.a476e700.js";import{G as ce}from"./GroupGamesCard.6c4be3bb.js";class de{constructor(o){this.accountId=o.accountId,this.id=o.id,this.groupId=o.groupId,this.profile=new F(o.profile),this.isOnline=o.isOnline||!1}}class ue{async addGroupMember(o){const t=await C.post("/api/groupmembers",{groupId:o});n.groupMembers=[new de(t.data),...n.groupMembers]}async leaveGroup(o,t){n.groupMembers.find(h=>h.accountId==n.account.id)?await C.delete(`api/groupmembers/${o}`,t):(await C.delete(`api/groupmembers/${o}`),n.groupMembers=n.groupMembers.filter(h=>h.id!==o)),X.push({name:"Account"})}}const E=new ue;const le={props:{group:{type:Z,required:!0}},setup(a){return{editable:U({}),groupMember:p(()=>n.groupMembers),alreadyAMember:p(()=>n.groupMembers.find(t=>t.accountId==n.account.id)),groupOwner:p(()=>a.group.creatorId==n.account.id),memberId:p(()=>n.groupMembers.find(t=>t.accountId==n.account.id)),async removeGroup(){try{if(this.groupOwner||d.toast("Forbidden: Not Your Group","warning","top-end",1e3),a.group.groupMemberIds>1&&d.toast("Group has members, leave group instead.","warning","top-end",1e3),!await d.confirm())return;await S.removeGroup(a.group.id),d.success("Group Removed")}catch(t){d.error(t,"[removeGroupMember]")}},async addGroupMember(){try{a.group.creatorId==n.account.id?d.error("Already made this group and are already part of it"):(await E.addGroupMember(a.group.id),d.success(`You Joined ${a.group.name} !`))}catch(t){d.error(t,"[addMemberToGroup]")}},async leaveGroup(){try{if(a.group.creatorId==n.account.id&&!await d.confirm("Are you sure you want to leave? You'll have to choose a new group owner...")||!await d.confirm("Are you sure you want to leave?"))return;await E.leaveGroup(this.memberId.id),d.success(`Left ${a.group.name}`)}catch(t){d.error(t,"[leaveGroup]")}},async editGroup(){}}}},A=a=>(j("data-v-3c4acde1"),a=a(),T(),a),me={class:"d-flex"},pe=A(()=>e("button",{class:"btn text-light hover rounded-circle",type:"button","data-bs-toggle":"collapse","data-bs-target":"#groupButtons","aria-expanded":"false","aria-controls":"collapseWidthExample"},[e("i",{class:"mdi mdi-dots-horizontal fs-1 text-white hover rounded-5 dropdownbtn"})],-1)),_e={class:"collapse",id:"groupButtons"},he={class:"logicButtons d-flex"},ge={key:0},be=A(()=>e("button",{class:"btn btn-warning button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#inviteMemberForm"}," Invite Member ",-1)),ve=[be],ye=A(()=>e("button",{class:"btn button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#gameNightForm"}," Create Gamenight ",-1)),fe={key:1},Ge={key:3},we={key:5},xe={class:"row justify-content-center mb-3"},Ie={class:"col-md-6 text-center bannerBg my-2 rounded text-light elevation-3"},Ce={class:"name"},$e={class:"mb-3"},ke=A(()=>e("span",null,[e("div",{class:"text-shadow fs-4"},"Members")],-1)),Me={class:"d-flex justify-content-center align-items-center bg-c1 p-2 rounded-5 mb-2 groupMemberBar flex-wrap"},Be=["src","alt","title"],Se={key:0,class:"rounded-circle onlineThing bg-success position-absolute end-50 glow2"};function Ne(a,o,t,s,h,b){var c,v;const m=f("router-link");return r(),i("div",{class:"col-md-11 rounded banner elevation-3",style:V({backgroundImage:`url(${(c=t.group)==null?void 0:c.coverImg})`})},[e("div",me,[pe,e("div",_e,[e("div",he,[s.groupOwner?(r(),i("div",ge,ve)):$("",!0),ye,s.groupOwner?(r(),i("div",fe,[e("button",{onClick:o[0]||(o[0]=u=>s.editGroup()),class:"btn btn-warning button-51 py-1 px-2 m-2","data-bs-toggle":"modal","data-bs-target":"#editForm"}," Edit group ")])):$("",!0),s.alreadyAMember?(r(),i("div",Ge,[e("button",{onClick:o[2]||(o[2]=u=>s.leaveGroup()),class:"btn button-51 py-1 px-2 m-2"}," Leave Group ")])):(r(),i("button",{key:2,onClick:o[1]||(o[1]=u=>s.addGroupMember()),class:"btn button-50 py-1 px-2 m-2"}," Join Group ")),s.groupOwner?(r(),i("button",{key:4,onClick:o[3]||(o[3]=u=>s.removeGroup()),class:"btn btn-danger button-51 py-1 px-2 m-2"}," Delete Group ")):(r(),i("div",we))])])]),e("div",xe,[e("div",Ie,[e("span",Ce,g((v=t.group)==null?void 0:v.name),1),e("div",$e,[ke,e("div",Me,[(r(!0),i(k,null,M(s.groupMember,u=>(r(),O(m,{to:{name:"Profile",params:{id:u==null?void 0:u.accountId}},key:u==null?void 0:u.id},{default:L(()=>{var y,_,w;return[e("img",{src:(y=u.profile)==null?void 0:y.picture,alt:(_=u.profile)==null?void 0:_.name,title:(w=u.profile)==null?void 0:w.name,height:"45",width:"45",class:"rounded-circle box-shadow m-1 profile-img position-relative"},null,8,Be),u.profile.isOnline?(r(),i("span",Se)):$("",!0)]}),_:2},1032,["to"]))),128))])])])])],4)}const Ae=B(le,[["render",Ne],["__scopeId","data-v-3c4acde1"]]);const Le={props:{gamenight:{type:K,required:!0}},setup(a){const o=["url(https://images.unsplash.com/photo-1500995617113-cf789362a3e1)","url(https://images.unsplash.com/photo-1611891487122-207579d67d98)","url(https://images.unsplash.com/photo-1547638375-ebf04735d792)","url(https://images.unsplash.com/photo-1606503153255-59d8b8b82176)","url(https://images.unsplash.com/photo-1561079028-f20597c34f21)","url(https://images.unsplash.com/photo-1606559497615-e4787c3c75a1)","url(https://images.unsplash.com/photo-1563811771046-ba984ff30900)"];return{gameNightCreator:p(()=>a.gamenight.creatorId==n.account.id),groupOwner:p(()=>a.gamenight.groupCreator==n.account.id),attending:p(()=>a.gamenight.groupMemberIds.find(t=>t.id==n.account.id)),memberGoing:p(()=>{seeTheSame(groupMembers,a.gamenight.groupMemberIds),seeTheSame(a.gamenight.groupMemberIds,groupMembers)}),getRandomBg(){return o[Math.floor(o.length*Math.random())]},seeTheSame(t,s){return t.filter(h=>s.some(b=>h.id===b.id))},async removeGameNight(){try{if(!await d.confirm("Cancel this gamenight??"))return;await N.removeGameNight(a.gamenight.id)}catch(t){D.error("[]",t),d.error(t)}},async addGameNight(){try{await N.addGameNight(a.gamenight.id)}catch(t){d.error(t)}},async attendGamenight(t){try{await N.attendGamenight(t)}catch(s){D.error(s),d.error(s.message)}}}}},G=a=>(j("data-v-39e3ce11"),a=a(),T(),a),Oe={class:"row justify-content-center"},je={class:"col-7 col-md-8 rounded bg-c4 m-2 upcomingGameNight"},Te={class:"d-flex justify-content-center mt-2 text-center"},De=G(()=>e("h2",null,"Upcoming Gamenight",-1)),Pe={class:"d-flex justify-content-center mb-2"},Ee=q(" I'm Attending "),Re=G(()=>e("i",{class:"bi bi-person-plus-fill"},null,-1)),Fe=[Ee,Re],Ue=q(" Unattend "),Ve=G(()=>e("i",{class:"bi bi-person-dash-fill"},null,-1)),ze=[Ue,Ve],qe={class:"justify-content-center d-flex"},Ye={class:"mx-4"},Je=G(()=>e("p",null,null,-1)),We={class:"col-5 col-md-6 p-0 ps-md-3"},He={class:"card m-2 noborder"},Xe=G(()=>e("div",{class:"bg-c4 text-center rounded-top"},[e("h5",{class:"mt-1"},"Attending:")],-1)),Ze={key:0,class:"p-2 bg-c2 text-center rounded-bottom"},Ke=["src","alt","title"],Qe={class:"col-5 col-md-6 p-0 pe-md-3"},et={class:"card m-2 noborder elevation-4"},tt=G(()=>e("div",{class:"bg-c4 text-center p-1 rounded-top"},[e("h5",{class:"mt-1"},"Playing:")],-1)),ot={class:"bg-c2 p-2 rounded-bottom"},at={class:"d-flex justify-content-center"},st={class:"col-md- bg-c2 rounded-1 fs-5 text-center px-3 py-1 my-1"},rt={class:"namefont"};function nt(a,o,t,s,h,b){var c,v,u,y,_,w;const m=f("router-link");return r(),i("div",{class:z([new Date((c=t.gamenight)==null?void 0:c.startDate)<=Date.now()?"test disabled":"","GameNightCard card my-2 elevation-3 position-relative"]),style:V({backgroundImage:s.getRandomBg()})},[e("div",Oe,[e("div",je,[e("div",Te,[De,s.gameNightCreator||s.groupOwner?(r(),i("i",{key:0,title:"Remove Game Night",class:"mdi mdi-close text-danger fs-4 selectable position-absolute rounded x",onClick:o[0]||(o[0]=x=>s.removeGameNight())})):$("",!0)]),e("div",Pe,[s.attending?(r(),i("button",{key:1,class:"btn button-51 animate__animated animate__fadeIn",onClick:o[2]||(o[2]=x=>{var l;return s.attendGamenight((l=t.gamenight)==null?void 0:l.id)})},ze)):(r(),i("button",{key:0,class:"btn button-51 animate__animated animate__fadeIn",onClick:o[1]||(o[1]=x=>{var l;return s.attendGamenight((l=t.gamenight)==null?void 0:l.id)})},Fe))]),e("div",qe,[e("span",null,[e("p",null,g(new Date((v=t.gamenight)==null?void 0:v.startDate).toLocaleDateString("en-us",{month:"short",day:"2-digit",year:"numeric"})),1)]),e("span",Ye,[e("p",null,g(new Date((u=t.gamenight)==null?void 0:u.startDate).toLocaleTimeString("en-us",{hour:"2-digit",minute:"2-digit"})),1)]),e("span",null,[e("p",null,"At: "+g((y=t.gamenight)==null?void 0:y.location),1),Je])])]),e("div",We,[e("div",He,[Xe,(_=t.gamenight)!=null&&_.groupMemberIds?(r(),i("div",Ze,[I(Q,{name:"custom-classes",enterActiveClass:"animate__zoomIn animate__animated",leaveActiveClass:"animate__zoomOut animate__animated"},{default:L(()=>{var x;return[(r(!0),i(k,null,M((x=t.gamenight)==null?void 0:x.groupMemberIds,l=>(r(),O(m,{to:{name:"Profile",params:{id:l==null?void 0:l.id}},key:l.id},{default:L(()=>[e("img",{src:l==null?void 0:l.picture,alt:l==null?void 0:l.name,title:l==null?void 0:l.name,height:"45",width:"45",class:"rounded-circle box-shadow m-1 profile-img"},null,8,Ke)]),_:2},1032,["to"]))),128))]}),_:1})])):$("",!0)])]),e("div",Qe,[e("div",et,[tt,e("div",ot,[e("div",at,[e("div",st,[e("b",rt,g((w=t.gamenight)==null?void 0:w.game),1)])])])])])])],6)}const it=B(Le,[["render",nt],["__scopeId","data-v-39e3ce11"]]);class J{constructor(o){this.id=o.id,this.groupId=o.groupId,this.creatorId=o.creatorId,this.body=o.body,this.creator=new F(o.creator),this.createdExactTime=o.createdAt,this.createdAt=new Date(o.createdAt).toLocaleDateString("en-Us",{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"})}}class ct{async getGroupChatsByGroupId(o){const t=await C.get(`api/groupchats/${o}`);n.groupChats=t.data.map(s=>new J(s))}async addGroupChat(o){await C.post("api/groupchats/",o)}}const W=new ct,dt={setup(){let a=U({});const o=Y();return{editable:a,async handleSubmit(){try{if(!n.account.id)return ee.loginWithPopup();const t=o.params.id;a.value.groupId=t,await W.addGroupChat(a.value),a.value={}}catch(t){d.error(t,"handleChatSubmit")}}}}},ut={class:"bg-dark rounded ms-2"},lt=e("div",{class:"row"},[e("div",{class:"d-flex justify-content-between"},[e("div",{class:"p-2 mt-2 ms-1"},"Add post. . ."),e("button",{class:"btn bg-c6 mx-2 my-2 rounded-pill",type:"submit","aria-label":"Submit Post",title:"Submit"}," Post ")])],-1),mt={class:"text-start d-flex justify-content-center"},pt={class:""},_t={class:"form-group text-center m-1"},ht=e("div",null,null,-1);function gt(a,o,t,s,h,b){return r(),i("div",ut,[e("form",{onSubmit:o[1]||(o[1]=ae((...m)=>s.handleSubmit&&s.handleSubmit(...m),["prevent"]))},[lt,e("div",mt,[e("div",pt,[e("div",_t,[te(e("textarea",{class:"p-2 rounded w-100",rows:"2","onUpdate:modelValue":o[0]||(o[0]=m=>s.editable.body=m),cols:"150",placeholder:"",required:"",name:"postcontent"},null,512),[[oe,s.editable.body]])])]),ht])],32)])}const bt=B(dt,[["render",gt]]);const vt={props:{chat:{type:J,required:!0}},setup(a){return{account:p(()=>n.account)}}},yt={class:"chatContainer container animate__animated animate__fadeIn"},ft={class:"row"},Gt={class:"col-12"},wt={key:0,class:"d-flex gap-1 justify-content-end pt-2 pb-2"},xt={class:"mt-2 time"},It={class:""},Ct={key:1,class:"d-flex gap-1 justify-content-start animate__animated animate__fadeInLeft"},$t={class:"bg-c4 rounded p-2 my-2 max-width"},kt=["src","alt","title"],Mt={class:""},Bt={class:"mt-3 time"};function St(a,o,t,s,h,b){var m,c;return r(),i("div",yt,[e("div",ft,[e("div",Gt,[((m=t.chat)==null?void 0:m.creatorId)==((c=s.account)==null?void 0:c.id)?(r(),i("div",wt,[e("span",xt,g(t.chat.createdAt),1),e("div",{class:z(["bg-c2 rounded-3 p-2 max-width",s.account?"bg-c1 ":"bg-success"])},[e("span",It,g(t.chat.body),1)],2)])):(r(),i("div",Ct,[e("div",$t,[e("img",{src:t.chat.creator.picture,alt:t.chat.creator.name,title:t.chat.creator.name,class:"rounded-circle me-2 profilePic",height:"20",width:"20"},null,8,kt),e("span",Mt,g(t.chat.body),1)]),e("span",Bt,g(t.chat.createdAt),1)]))])])])}const Nt=B(vt,[["render",St],["__scopeId","data-v-17e6fe8c"]]);class R{static EnterGroup(o){P.emit("ENTER_GROUP",o)}static LeaveGroup(o){P.emit("LEAVE_GROUP",o)}}const At={setup(){const a=Y();async function o(){try{await S.getGroupById(a.params.id)}catch(c){d.error(c,"[getGroupById]")}}async function t(){try{await S.getGroupMembers(a.params.id)}catch(c){d.error(c,"[getGroupMemberByGroupId]")}}async function s(){try{await ie.getListsByGroupId(a.params.id)}catch(c){d.error(c,"[getListsByGroupId]")}}async function h(){try{await W.getGroupChatsByGroupId(a.params.id)}catch(c){d.error(c,"[getListsByGroupId]")}}async function b(){try{await N.getGroupGameNights(a.params.id)}catch(c){d.error(c,"[groupGameNights]")}}function m(){let c=document.getElementById("chatbox");if(!c)return setTimeout(m,500);c.scrollTop=9999}return se(()=>{o(),t(),s(),h(),b(),m(),R.EnterGroup(a.params.id)}),re(()=>{R.LeaveGroup(a.params.id)}),{chats:p(()=>n.groupChats),group:p(()=>n.activeGroup),lists:p(()=>n.groupFilteredLists),account:p(()=>n.account),gamenights:p(()=>n.groupGameNights.reverse()),groupOwner:p(()=>n.activeGroup.creatorId==n.account.id),async createGroup(){try{await S.createGroup()}catch(c){d.error(c,"[createGroup]")}}}},components:{GroupBanner:Ae,GameNightCard:it,GroupChatInput:bt,GroupGamesCard:ce,Chat:Nt,GameNightForm:ne}},H=a=>(j("data-v-f9b2c4ae"),a=a(),T(),a),Lt={key:0,class:"animate__animated animate__fadeOut"},Ot={key:1,class:"group-page animate__animated animate__fadeInRight container-fluid"},jt={class:"row justify-content-center mb-4 mt-2"},Tt={class:"row justify-content-center"},Dt={class:"col-md-3 bg-dark rounded mt-2"},Pt=H(()=>e("div",{class:"bg-c6 rounded px-2 py-2 my-2 text-center mx-5"},[e("h4",null,"Group Chat")],-1)),Et={class:"overflow-auto groupchatbox bg-dark lighten-10 rounded",id:"chatbox"},Rt={class:"col-md-5 overflow-auto gamecardbox mx-5"},Ft={class:"px-1"},Ut={class:"col-md-3 overflow-auto gamecardbox bg-dark pt-2 mt-2 rounded"},Vt=H(()=>e("div",{class:"bg-c1 rounded text-center pt-2 pb-1 mx-5"},[e("h4",null,"Group Games")],-1)),zt={class:"mt-2"},qt={class:"row flex-wrap"};function Yt(a,o,t,s,h,b){const m=f("GroupBanner"),c=f("Chat"),v=f("GroupChatInput"),u=f("GameNightCard"),y=f("GroupGamesCard");return s.group?(r(),i("div",Ot,[e("div",jt,[I(m,{class:"mt-2 rounded",group:s.group},null,8,["group"])]),e("div",Tt,[e("div",Dt,[Pt,e("div",Et,[(r(!0),i(k,null,M(s.chats,_=>(r(),i("div",{class:"col-md-12",key:_.id},[I(c,{chat:_},null,8,["chat"])]))),128))]),I(v)]),e("div",Rt,[e("div",Ft,[(r(!0),i(k,null,M(s.gamenights,_=>(r(),O(u,{gamenight:_},null,8,["gamenight"]))),256))])]),e("div",Ut,[Vt,e("div",zt,[e("div",qt,[(r(!0),i(k,null,M(s.lists,_=>(r(),i("div",{key:_.id,class:"mt-4 col-12"},[I(y,{boardGameList:_},null,8,["boardGameList"])]))),128))])])])])])):(r(),i("div",Lt," loading.... "))}const Ht=B(At,[["render",Yt],["__scopeId","data-v-f9b2c4ae"]]);export{Ht as default};
